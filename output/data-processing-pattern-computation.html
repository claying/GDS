<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="author" content="Dexiong Chen" />
    <meta name="robots" content="index, follow"/>

    <meta property="og:title" content="Data Processing, Pattern computation"/>
    <meta property="og:url" content="./data-processing-pattern-computation.html"/>
    <meta property="og:site_name" content="Genetic Determinants Selection"/>
    <meta property="og:type" content="article"/>

    <link rel="canonical" href="./data-processing-pattern-computation.html" />

    <title>Data Processing, Pattern computation | Genetic Determinants Selection</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="./theme/css/font-awesome.css" />
    <link rel="stylesheet" type="text/css" href="./theme/css/bootstrap-combined.min.css" />

    <link rel="stylesheet" type="text/css" href="./theme/css/main.css" />

    <link rel="stylesheet" type="text/css" href="./theme/css/image.css" />

    <script type="text/javascript">var switchTo5x=true;</script>
    <script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
    <script type="text/javascript">
        stLight.options({
            publisher: "",
            doNotHash: false,
            doNotCopy: false,
            hashAddressBar: false
        });
    </script>
</head>

<body id="index">
    <div class="row-fluid">
        <div class="span10 offset1">
            <header id="banner" >
                <h1>
                    <a href="./">Genetic Determinants Selection </a>
                </h1>
                <nav class="navbar">
                    <div class="navbar-inner">
                        <ul class="nav">
                            <li class="active"><a href="./category/notes.html">notes</a></li>
                        </ul>

                    </div>
                </nav>
            </header><!-- /#banner -->
        </div>
    </div>

    <div class="row-fluid">
        <div class="span10 offset1">
            <div class="row-fluid">
<div class="span10 offset1">
  <section>
    <article>
      <header>
        <h1 class="entry-title">
          <a href="./data-processing-pattern-computation.html" rel="bookmark"
             title="Permalink to Data Processing, Pattern computation">Data Processing, Pattern&nbsp;computation</a></h1>
      </header>
      <div class="entry-content">
<footer class="post-info">
    <address class="vcard author">
        by <a class="url fn" href="./author/dexiong-chen.html">Dexiong Chen</a>
    </address>

    in <a href="./category/notes.html">notes</a>

    on 2016-04-04

        |
        tags:         <a href="./tag/data-processing.html">data processing</a>
        <a href="./tag/k-mer.html">k-mer</a>
        <a href="./tag/notes.html">notes</a>



    
</footer><!-- /.post-info -->

        <p>Based on the kernel methods, the problem of generic determinants selection can be formulated as&nbsp;following:
</p>
<div class="math">$$\min_{\beta\in\mathbb R^{p}}\frac{1}{n}\sum_{i=1}^{n}L\left(Y_i, \phi_i \cdot \beta\right)+\lambda \Omega(\beta)$$</div>
<p>
where <span class="math">\(L\)</span> is a loss function and <span class="math">\(\Omega\)</span> is a regularization function.
The vector <span class="math">\(\phi_i\)</span> is a feature vector obtained by mapping the sequence <span class="math">\(i\)</span> to the Hilbert space <span class="math">\(\mathbb R^p\)</span>.</p>
<p>There are different choices of the mapping&nbsp;function:</p>
<ul>
<li>spectrum kernel: <span class="math">\(\phi_i\)</span> denote the vector of the number of occurrences of each present&nbsp;k-mer.</li>
<li>substring&nbsp;kernel</li>
</ul>
<p>In all cases, the kernel function is supposed to be a comparison function or a similarity measure, and <span class="math">\(\phi\)</span> is a mapping projecting original space to a more easily comparable&nbsp;space.</p>
<p>Our first approach is to apply spectrum kernel for k-mers of different lengths. To have a straightforward feeling of the presence of k-mers of different lengths, we can also display some visualization using these feature&nbsp;matrices.</p>
<h2>Computing feature&nbsp;matrices</h2>
<p>To compute the feature matrices in a reasonable time, I used a toolbox implemented in Python interface, called <a href="http://www.shogun-toolbox.org/"><span class="caps">SHOGUN</span></a>. This package allows to construct a dictionary representation of the k-mer vocabulary of the training set, in such a way that it maps each sequence to indices. After computing the vector of indices for each sequence, we can easily construct a sparse matrix <span class="math">\(\phi\)</span> in Python.
I have computed feature matrices for k-mers of length from 5 to 10, the space memory of these matrices becomes larger and larger but with lower growth for bigger&nbsp;k.</p>
<h2>Analysis and visualization of feature&nbsp;matrices</h2>
<p>One can compute easily the number of presences of each k-mer in sequences by replacing the values of matrix <span class="math">\(\phi\)</span> by 1 and summing along the&nbsp;columns.</p>
<div class="highlight"><pre><span></span>k = 5 # length of k-mers
M = load_coo_matrix(&#39;data/features_matrix_&#39;+str(k)+&#39;.npz&#39;) # load matrix $\phi$
M.data[:] = 1 # without taking account of repetitions
S = M.sum(axis=0) # number of presences of each k-mer
</pre></div>


<h5>Curves of minimal number of&nbsp;presences</h5>
<p><img alt="k-mer-presence" src="/images/kmer-presences/5.png" />
<img alt="k-mer-presence" src="/images/kmer-presences/6.png" />
<img alt="k-mer-presence" src="/images/kmer-presences/7.png" />
<img alt="k-mer-presence" src="/images/kmer-presences/8.png" />
<img alt="k-mer-presence" src="/images/kmer-presences/9.png" />
<img alt="k-mer-presence" src="/images/kmer-presences/10.png" />
<img alt="k-mer-presence" src="/images/kmer-presences/11.png" />
<img alt="k-mer-presence" src="/images/kmer-presences/12.png" />
<img alt="k-mer-presence" src="/images/kmer-presences/13.png" />
<img alt="k-mer-presence" src="/images/kmer-presences/14.png" />
<img alt="k-mer-presence" src="/images/kmer-presences/15.png" /></p>
<p>With the growth of k, we can see that the number of presences of each feature gets lower and lower and eventually gets concentrated near 0. We can also set log-scale for axis <span class="math">\(y\)</span> for large k to visualize better the behavior near&nbsp;0.</p>
<p><img alt="k-mer-presence" src="/images/kmer-presences/log-13-2.png" />
<img alt="k-mer-presence" src="/images/kmer-presences/log-14-2.png" />
<img alt="k-mer-presence" src="/images/kmer-presences/log-15-2.png" /></p>
<p>These figures give us an overview of presence of features and also an intuition to filter some k-mers which don&#8217;t seem as important as others. For example, in the case k=15, the k-mers that only present once in the sequences occupy <span class="math">\(\frac{3}{4}\)</span> of total features. By consequence, if we remove all these features, the new feature matrix becomes 4 times smaller than the original&nbsp;one.</p>
<h4>Distribution of presence for&nbsp;k-mers</h4>
<p><img alt="k-mer-presence" src="/images/kmer-presences/hist-5.png" />
<img alt="k-mer-presence" src="/images/kmer-presences/hist-6.png" />
<img alt="k-mer-presence" src="/images/kmer-presences/hist-7.png" />
<img alt="k-mer-presence" src="/images/kmer-presences/hist-8.png" />
<img alt="k-mer-presence" src="/images/kmer-presences/hist-9.png" />
<img alt="k-mer-presence" src="/images/kmer-presences/hist-10.png" />
<img alt="k-mer-presence" src="/images/kmer-presences/hist-11.png" />
<img alt="k-mer-presence" src="/images/kmer-presences/hist-12.png" />
<img alt="k-mer-presence" src="/images/kmer-presences/hist-13.png" />
<img alt="k-mer-presence" src="/images/kmer-presences/hist-14.png" />
<img alt="k-mer-presence" src="/images/kmer-presences/hist-15.png" /></p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }, linebreaks: { automatic: false, width: 'container' }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

      </div><!-- /.entry-content -->

    </article>
  </section>
</div>
            </div>
        </div>
    </div>

    <footer id="site-footer">
        <div class="row-fluid">
            <div class="span10 offset1">
                <address>
                    <p>
                        This blog is proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                    </p>
                    <p>
                        <a href="http://github.com/jsliang/pelican-fresh/">Fresh</a> is a responsive theme designed by <a href="http://jsliang.com/">jsliang</a> and <a href="https://github.com/jsliang/pelican-fresh/graphs/contributors">contributors</a>.
                        Special thanks to <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a> and <a href="http://getbootstrap.com/">Twitter Bootstrap</a>.
                    </p>
                </address>
            </div>
        </div>
    </footer>

    <script src="//code.jquery.com/jquery.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/2.3.2/js/bootstrap.min.js"></script>
</body>
</html>